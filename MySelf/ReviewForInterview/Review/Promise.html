<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

</body>
<script>
    // let test = new Promise((resolve, reject) => {
    //     if (true) {
    //         resolve(1)
    //     } else {
    //         reject(2)
    //     }
    // })
    // console.log(test, '--test--')

    // function Promise(executor) {
    //     this.status = 'pending';
    //     this.value = null
    //     this.reason = null
    //     this.onResolvedArray = []
    //     this.onRejectedArray = []
    //     const resolve = value => {
    //         setTimeout(() => {
    //             if (this.status == 'pending') {
    //                 this.value = value
    //                 this.status = 'fulfilled'
    //                 this.onResolvedArray.forEach(fn => fn(this.value))
    //             }
    //         })
    //     }
    //     const reject = reason => {
    //         setTimeout(() => {
    //             if (this.status == 'pending') {
    //                 this.reason = reason
    //                 this.status = 'rejected'
    //                 this.onRejectedArray.forEach(fn => fn(this.reason))
    //             }
    //         })
    //     }
    //     executor(resolve, reject)
    // }

    // Promise.prototype.then = function (onResolved, onRejected) {
    //     if (this.status == 'fulfilled') {
    //         return new Promise((resolve, reject) => {
    //             setTimeout(() => {
    //                 try {
    //                     let result = onResolved(this.value)
    //                     resolve(result)
    //                 } catch (e) {
    //                     reject(e)
    //                 }
    //             })
    //         })
    //     }
    //     if (this.status == 'rejected') {
    //         return new Promise((resolve, reject) => {
    //             setTimeout(() => {
    //                 try {
    //                     let result = onRejected(this.reason)
    //                     resolve(result)
    //                 } catch (e) {
    //                     reject(e)
    //                 }
    //             })
    //         })
    //     }
    //     if (this.status == 'pending') {
    //         return new Promise((resolve, reject) => {
    //             this.onResolvedArray.push(() => {
    //                 try {
    //                     let result = onResolved(this.value)
    //                     resolve(result)
    //                 } catch (e) {
    //                     reject(e)
    //                 }
    //             })
    //             this.onRejectedArray.push(() => {
    //                 try {
    //                     let result = onRejected(this.reason)
    //                     resolve(result)
    //                 } catch (e) {
    //                     reject(e)
    //                 }
    //             })
    //         })
    //     }
    // }

    class Promise {
        constructor(executor) {
            this.status = 'pending';
            this.value = null;
            this.reason = null;
            let resolve = (value) => {
                if (this.status == 'pending') {
                    this.status = 'fulfilled'
                    this.value = value;
                }
            }
            let reject = (reason) => {
                if (this.status == 'pending') {
                    this.status = 'rejected'
                    this.reason = reason
                }
            }
            try {
                executor(resolve, reject)
            } catch (err) {
                reject(err)
            }
        }

        then(onFulfilled, onRejected) {
            if (this.status == 'fulfilled') {
                onFulfilled(this.value)
            }
            if (this.status == 'rejected') {
                onRejected(this.reason)
            }
        }
    }




</script>

</html>